"use strict";PULSE.app.templates.matchweekblogentry='<div class="mw-blog-card {{#showClubTheme}}{{ optaId }}{{/showClubTheme}} {{ theme }} {{#clubBadge}}has-club-badge{{/clubBadge}}"> <div class="mw-blog-card__meta"> <div class="mw-blog-card__icon-container"> {{#clubBadge}} <span class="badge badge-image-container" data-widget="club-badge-image" data-size="50"> <img class="badge-image badge-image--32 js-badge-image" src="{{ clubBadge }}" srcset="{{ clubBadge }}, {{ clubBadgeRetina }} 2x"> </span> {{/clubBadge}} {{^clubBadge}} {{#iconClass}} <img class="mw-blog-card__icon" src="https://resources.premierleague.com/premierleague/blog-icons/{{ iconClass }}.png"> {{/iconClass}} {{/clubBadge}} </div> <div class="mw-blog-card__time-container"> <span class="mw-blog-card__time">{{ time }}</span> {{#gameTime}} <span class="mw-blog-card__game-time">{{ gameTime }}</span> {{/gameTime}} </div> </div> <div class="mw-blog-card__content"> <h6 class="mw-blog-card__title"> {{ title }} </h6> <div class="mw-blog-card__text">{{{ comment }}}</div> </div> </div>',PULSE.app.templates.matchweekheaderevent='<li class="blog-header__event">{{{ title }}}</li>',PULSE.app.templates.matchweekpinnedblogentry='<div class="blogCard blogCard__pinned"> <div class="cardMeta"> <div class="icon {{ iconClass }}"> {{#icon}} <div class="icn {{ icon.html }}"></div> {{/icon}} </div> <time>{{ time }}</time> </div> <div class="cardContent"> <p class="label"><span class="icn pin-post-w"></span> {{ pinLabel }}</p> <div class="score">{{ properties.score }}</div> <h6 class="header">{{ title }}</h6> <p>{{{ comment }}}</p> </div> </div> ',PULSE.app.templates.latestmatchweektext='{{#contents}} <div class="editorial-list__item"> <article class="media-thumbnail {{#additionalClass}}{{additionalClass}}{{/additionalClass}}" data-widget="lazy-load-images"> <a href="{{ articleUrl }}" class="media-thumbnail__link"> <header class="media-thumbnail__header"> <div class="media-thumbnail__image-container placeholder"> <div class="js-lazy-load u-observed lazy-image-wrapper is-loaded" data-picture-in-view="true"> <div class="picture-wrapper"> <picture class="object-fit-cover-picture"> {{#imgUrl}} <source media="(max-width: 400px)" srcset="{{ imgUrl.mobile }}"> <img class="js-faded-image fade-in-on-load object-fit-cover-picture__img is-loaded media-thumbnail__image" src="{{ imgUrl.default }}" alt="{{ title }}"> {{/imgUrl}} </picture> </div> </div> </div> </header> <div class="media-thumbnail__content"> {{#subtitle}} <span class="media-thumbnail__tag">{{ subtitle }}</span> {{/subtitle}} <span class="media-thumbnail__title">{{ title }}</span> <p class="media-thumbnail__description"> {{ description }} </p> </div> </a> </article> </div> {{/contents}}',PULSE.app.templates.latestmatchweekvideo='{{#contents}} <div class="editorial-list__item"> <article class="media-thumbnail" data-widget="lazy-load-images"> <a href="#!" class="media-thumbnail__link"> <header class="media-thumbnail__header"> <div class="media-thumbnail__image-container placeholder"> <div class="js-lazy-load u-observed lazy-image-wrapper is-loaded" data-picture-in-view="true"> <div class="picture-wrapper"> <picture class="object-fit-cover-picture"> <source media="(max-width: 400px)" srcset="{{ imgUrl.mobile }}"> <img class="js-faded-image fade-in-on-load object-fit-cover-picture__img is-loaded media-thumbnail__image" src="{{ imgUrl.default }}" alt="{{ title }}"> </picture> </div> </div> <div class="media-thumbnail__meta-tag"> <svg class="icon media-thumbnail__meta-tag-icon" aria-hidden="true"> <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/resources/{{ resourceVersion }}/i/svg-output/icons.svg#icn-play"></use> </svg> {{ videoDuration }} </div> </div> </header> <div class="media-thumbnail__content"> <div class="media-thumbnail__video-tags"> {{#ccString}}<span class="closedCaption">{{ ccString }}</span>{{/ccString}} {{#avString}}<span class="audioDesc">{{avString}}</span>{{/avString}} </div> <span class="media-thumbnail__title">{{ title }}</span> </div> </a> </article> </div> {{/contents}}',PULSE.app.templates.nomatchweeklatestlist='<li class="noContentContainer">{{ label }}</li>',PULSE.app.templates.allquestions='<h3 class="subHeader">{{ questionLabel }}</h3> <ul> {{#questions}} <li data-id="{{ id }}"> <div class="question" tabindex="0"> <span>{{ text }}</span> <span class="questionIcon"> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 15.085 9.422" xml:space="preserve"> <path d="M15.084,4.709c-0.013-0.285-0.106-0.581-0.325-0.782l-1.215-1.216l-1.941-1.94l-0.445-0.446 c-0.21-0.204-0.489-0.32-0.782-0.325c-0.271,0-0.595,0.12-0.781,0.325C9.403,0.536,9.259,0.812,9.27,1.107 c0.012,0.294,0.112,0.569,0.325,0.781l1.218,1.218l0.495,0.496H2.69c-0.519,0-1.041-0.006-1.56,0H1.107 c-0.285,0-0.58,0.124-0.781,0.326C0.133,4.12-0.01,4.432,0.001,4.709C0.014,4.993,0.107,5.29,0.326,5.49 c0.218,0.2,0.484,0.326,0.781,0.325h10.207L10.04,7.088L9.595,7.533c-0.2,0.2-0.324,0.5-0.325,0.782c0,0.271,0.12,0.595,0.325,0.781 c0.21,0.192,0.486,0.337,0.782,0.325c0.292-0.015,0.57-0.113,0.781-0.325l1.218-1.218l1.941-1.941l0.445-0.445 c0.114-0.113,0.194-0.248,0.247-0.392c0.052-0.124,0.078-0.258,0.076-0.392L15.084,4.709z"/> </svg> </span> </div> </li> {{/questions}} </ul> <h3 class="subHeader">{{ answerLabel }}</h3> <ul> {{#answers}} <li data-id="{{ id }}"> <div class="question" tabindex="0"> <span>{{ text }}</span> <span class="questionIcon"> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 15.085 9.422" xml:space="preserve"> <path d="M15.084,4.709c-0.013-0.285-0.106-0.581-0.325-0.782l-1.215-1.216l-1.941-1.94l-0.445-0.446 c-0.21-0.204-0.489-0.32-0.782-0.325c-0.271,0-0.595,0.12-0.781,0.325C9.403,0.536,9.259,0.812,9.27,1.107 c0.012,0.294,0.112,0.569,0.325,0.781l1.218,1.218l0.495,0.496H2.69c-0.519,0-1.041-0.006-1.56,0H1.107 c-0.285,0-0.58,0.124-0.781,0.326C0.133,4.12-0.01,4.432,0.001,4.709C0.014,4.993,0.107,5.29,0.326,5.49 c0.218,0.2,0.484,0.326,0.781,0.325h10.207L10.04,7.088L9.595,7.533c-0.2,0.2-0.324,0.5-0.325,0.782c0,0.271,0.12,0.595,0.325,0.781 c0.21,0.192,0.486,0.337,0.782,0.325c0.292-0.015,0.57-0.113,0.781-0.325l1.218-1.218l1.941-1.941l0.445-0.445 c0.114-0.113,0.194-0.248,0.247-0.392c0.052-0.124,0.078-0.258,0.076-0.392L15.084,4.709z"/> </svg> </span> </div> </li> {{/answers}} </ul>',PULSE.app.templates.pollanswers='<h3 class="subHeader">{{ question.text }}</h3> <ul> {{#question.options}} <li> <div class="question answer"> <span>{{ text }}</span> <span>{{ percentage }}</span> <span class="bar" style="width: {{ percentage }};"></span> </div> </li> {{/question.options}} </ul>',PULSE.app.templates.pollquestionamount='<span class="questions"> <strong class="">{{ number }}</strong> </span>',PULSE.app.templates.pollquestions='<h3 class="subHeader">{{ question.text }}</h3> <ul> {{#question.options}} <li data-optionid="{{ id }}" data-questionid="{{ question.id }}"> <div class="question" tabindex="0"> <span>{{ text }}</span> <span class="icn tick-w"></span> </div> </li> {{/question.options}} </ul>',PULSE.app.templates.deductedpoints='{{#pointsDeducted}} <p class="pointsDeductedContainer">{{ message }}</p> {{/pointsDeducted}}',PULSE.app.templates.leaguetablesmall='<tr class="tableDark" data-position="{{position}}"> <td class="pos"> <span class="value">{{ position }}</span> <span class="movement {{movement}}"><span class="visuallyHidden">{{startingPosition}}</span></span> </td> <td class="team" scope="row"> <a href="{{ url }}"> <span class="badge badge-image-container" data-widget="club-badge-image" data-size="25"> <img class="badge-image badge-image--25 js-badge-image" src="{{ clubBadge }}" srcset="{{ clubBadge }}, {{ clubBadgeRetina }} 2x"> </span> {{longName}} </a> </td> <td>{{ overall.played }}</td> <td>{{ overall.goalsDifference }}</td> <td class="points">{{ overall.points }}</td> </tr>',PULSE.app.templates.matchweektable='<tr data-position="{{position}}"> <td class="league-table__pos pos button-tooltip" tabindex="0" id="Tooltip"> <span class="league-table__value value">{{ position }}</span> <span class="league-table__movement {{movement}}"> <span class="league-table__tooltip-container tooltipContainer tooltip-left" role="tooltip"> <span class="league-table__tooltip-content tooltip-content"> <span class="league-table__result-highlight">{{startingPosition}} </span> </span> </span> </span> </td> <td class="league-table__team team" scope="row"> <a href="{{ url }}"> <span class="badge badge-image-container" data-widget="club-badge-image" data-size="50"> <img class="badge-image badge-image--32 js-badge-image" src="{{ clubBadge }}" srcset="{{ clubBadge }}, {{ clubBadgeRetina }} 2x"> </span> <span class="league-table__team-name league-table__team-name--long long">{{longName}}</span> <span class="league-table__team-name league-table__team-name--short short">{{team.club.abbr}}</span> </a> </td> <td>{{ overall.played }}</td> <td>{{ overall.goalsDifference }}</td> <td class="league-table__points points">{{ overall.points }}</td> </tr> ',function(e,t,n,a){let o=function(t){let n=this,a={method:"GET",callback:n.renderBlog,target:n};return t?(a.interval=e.pollingCacheRate,a.url=e.common.createLiveBlogPath(void 0,n.currentId,{maxResults:50})):a.url=e.common.createLiveBlogPath(void 0,n.currentId,{},n.belowPosition),a},l=function(e,t){let a=this;a.blogFeeds[e]?isNaN(t.interval)?a.blogFeeds[e].request():a.blogFeeds[e].start():a.blogFeeds[e]=n.data.manager.add(t)},i=function(e,t,n,a){for(let t in e)if(e.hasOwnProperty(t)){let a=e[t],o=a.config.url||"";isNaN(a.interval)||o.match("PremierLeague/"+n)||a.stop()}"function"==typeof a?a():console.warn("Error: Please supply a valid callback function to stopAnyOldPollingRequests")};e.matchWeekBlog=function(t){let n=this;n.element=t,n.blogCommentButton=n.element.getElementsByClassName("js-comment-button"),n.blogAuthorContainer=n.element.getElementsByClassName("js-blog-author"),n.blogStream=n.element.getElementsByClassName("js-blog-stream"),n.blogIds=[],n.blogFeeds=[],n.type="liveblog",n.currentId=n.element.getAttribute("data-blog-id"),n.getBlog(),n.matchweekDayDropdownContainer=n.element.getElementsByClassName("js-blog-dropdown"),n.setListeners(),n.loader=new e.common.scrollLoader(n.blogStream[0],n,!0)},e.matchWeekBlog.prototype.setListeners=function(){let e=this;if(e.matchweekDayDropdownContainer.length>0){let n={updateCurrent:!0,callback:e.changeBlogDay,target:e};new t.dropdown(e.matchweekDayDropdownContainer[0],n)}if(e.blogCommentButton.length>0){let t=e.blogCommentButton[0].getAttribute("data-email");e.blogCommentButton[0].addEventListener("click",(function(e){e.preventDefault(),window.location.href="mailto:"+t}))}},e.matchWeekBlog.prototype.changeBlogDay=function(e){let t=this,n=e.getAttribute("data-blog-id");n!=t.currentId&&(t.matchWeekBlogEntryContainer[0].innerHTML="",t.currentId=n,t.belowPosition=void 0,t.changeAuthor(n),t.blogIds=[],t.getBlog())},e.matchWeekBlog.prototype.changeAuthor=function(e){let t=this;if(t.blogAuthorContainer.length>0&&e)for(let n=0;n<t.blogAuthorContainer.length;n++){let a=t.blogAuthorContainer[n].getAttribute("data-blog-id");t.blogAuthorContainer[n].style.display=e!=a?"none":""}},e.matchWeekBlog.prototype.getBlog=function(){let e=this,t=o.call(this,!0),n="pollFeed"+t.url;i(e.blogFeeds,t.url,e.currentId,(function(){l.call(e,n,t)}))},e.matchWeekBlog.prototype.getOlderBlogEntries=function(){let e=this;if(0===e.belowPosition)return e.loader.contentLoaded(),void e.loader.completedDataLoad(!0);let t=o.call(this,!1),n="historicFeed"+t.url;i(e.blogFeeds,t.url,e.currentId,(function(){l.call(e,n,t)}))},e.matchWeekBlog.prototype.hasIdenticalBlogPosts=function(e){let t=this;return 0!==t.blogIds.length&&(0===t.getNewBlogPosts(e).length&&0===t.getUpdatedBlogPosts(e).length&&0===t.getDeletedBlogPosts(e).length)},e.matchWeekBlog.prototype.getNewBlogPosts=function(e){let t=this;return e.filter((function(e){return t.blogIds.every((function(t){return e.id!==t.id}))}))},e.matchWeekBlog.prototype.getUpdatedBlogPosts=function(e){let t=this;return e.filter((function(e,n){let a=e.pinnedEntry||!1;return e.newIndex=n,t.blogIds.some((function(t){return e.id===t.id&&(e.updateTime!==t.updateTime||a!==t.pinnedEntry)}))}))},e.matchWeekBlog.prototype.getDeletedBlogPosts=function(e){return this.blogIds.filter((function(t,n){return t.newIndex=-1,e.every((function(e){return t.id!==e.id&&!t.nextPage}))}))},e.matchWeekBlog.prototype.renderBlogEntries=function(n,o){let l=this;if(l.matchWeekBlogEntryContainer=l.element.getElementsByClassName("js-blog-feed"),0===l.matchWeekBlogEntryContainer.length)return;let i=l.rearrangeData(n);if(l.belowPosition=i[i.length-1].position,l.hasIdenticalBlogPosts(i))return;let s=[],r=[],c=l.getNewBlogPosts(i);if(r=c.length>0?r.concat(c):r,!o){let e=l.getUpdatedBlogPosts(i);r=e.length>0?r.concat(e):r;let t=l.getDeletedBlogPosts(i);r=t.length>0?r.concat(t):r}r.forEach((function(n,i){let r=function(t,n){let o=new Date(t.timestamp);return t.cardClass=0===n?"firstCard":"",t.time=moment(o).locale(e.language).format("HH:mm"),t.iconClass=(e=>{const t=e.icon,n=e?.properties?.additionalInfo;let a="";if(!t||!t.html)return"";switch(n){case"theme-pl-live":case"theme-pl":a=`${t.html}-white`;break;default:a=t.html}return a})(t),t.pinLabel=a.lookup("label.pinnedpost"),t}(n,i),d=document.querySelectorAll('[data-post-id="'+r.id+'"]'),m=n.pinnedEntry||!1,p=m?"js-pinned-post":"js-post",u=l.matchWeekBlogEntryContainer[0].getElementsByClassName(p)||!1,g=m?"matchweekpinnedblogentry":"matchweekblogentry",h=n.newIndex||0;if(d.length>0){d[0].parentNode.removeChild(d[0]);let e=l.blogIds.findIndex((function(e){return e.id===n.id}));if(l.blogIds.splice(e,1),h<0)return}s.push({id:n.id,updateTime:n.updateTime,pinnedEntry:m,nextPage:o}),r.subtitle&&(r.optaId=r.subtitle,r.clubBadge=t.getClubBadge(r.subtitle,"50"),r.teamScoredClubBadgeRetina=t.getClubBadge(r.subtitle,"50"),r.showClubTheme="theme-club"===r?.properties?.additionalInfo),r.theme=r?.properties?.additionalInfo,r.gameTime=r?.properties?.score?`${r.properties?.score}'`:null;let b=document.createElement("LI");b.setAttribute("class",p),b.setAttribute("data-post-id",r.id),b.innerHTML=Mustache.render(e.templates[g],r),o?l.matchWeekBlogEntryContainer[0].appendChild(b):l.matchWeekBlogEntryContainer[0].childNodes.length>c.length?u?h>0?l.matchWeekBlogEntryContainer[0].insertBefore(b,l.matchWeekBlogEntryContainer[0].childNodes[h]):l.matchWeekBlogEntryContainer[0].insertBefore(b,u[h]):l.matchWeekBlogEntryContainer[0].insertBefore(b,l.matchWeekBlogEntryContainer[0].firstElementChild):l.matchWeekBlogEntryContainer[0].appendChild(b)})),l.blogIds=l.blogIds.concat(s),t.refreshScripts(l.matchWeekBlogEntryContainer[0]),new e.LazyLoad(l.matchWeekBlogEntryContainer[0]),window.dispatchEvent(new CustomEvent(PULSE.app.common.constants.EVENTS.SCRIPTS.LIVE_BLOG.LOADED))},e.matchWeekBlog.prototype.rearrangeData=function(e){let t=void 0!==e.entries&&e.entries.length>0?e.entries.slice(0):e,n=e.overview?e.overview.header.keyEvents:[],a=t.sort((function(e,t){return t.position-e.position})),o=[],l=[];return n.forEach((function(e,t){let n=a.findIndex((function(t){return t.id===e.entryId}));n>=0&&(a[n].pinnedEntry=!0)})),a.forEach((function(e,t){e.pinnedEntry||!1?o.push(e):l.push(e)})),o.concat(l)},e.matchWeekBlog.prototype.renderHeader=function(n){let a=this;a.headerEventsContainer=a.element.getElementsByClassName("js-blog-events");let o=n.overview.header.headerEvents;if(a.headerEventsContainer.length>0&&o){let t="";o.forEach((function(n){t+=Mustache.render(e.templates.matchweekheaderevent,n)})),a.headerEventsContainer[0].innerHTML=t}if(a.matchweekBlogImageContainer=a.element.getElementsByClassName("js-blog-image-container"),a.matchweekBlogImageText=a.element.getElementsByClassName("js-matchweekBlogImageText"),a.matchweekBlogImageContainer.length>0){let e="";if(n.overview.header.leadMedia&&"photo"===n.overview.header.leadMedia.type){let a=t.getVariantWithWidth(n.overview.header.leadMedia.variants,900);a&&(e=a.url)}a.url!==e&&(a.matchweekBlogImageContainer[0].style.backgroundImage="url("+e+")",a.url=e)}if(a.matchweekBlogImageText.length>0){let e=n.overview.header.leadMedia.title||"";a.matchweekBlogImageText[0].innerHTML=e}a.headerTitleContainer=a.element.getElementsByClassName("js-blog-title"),a.headerTitleContainer.length>0&&(a.headerTitleContainer[0].innerHTML=n.overview.header.title)},e.matchWeekBlog.prototype.didRequestLoad=function(){this.getOlderBlogEntries()},e.matchWeekBlog.prototype.renderBlog=function(e,t){let n=this,a=-1===t.url.indexOf("below/");n.loader.contentLoaded(),e?(n.renderBlogEntries(e,!a),e.overview&&e.overview.header&&n.renderHeader(e,t)):n.loader.removeLoader()};let s=[].slice.call(document.querySelectorAll('[data-widget="match-week-blog"]'));for(let t=0;t<s.length;t++)new e.matchWeekBlog(s[t],{})}(PULSE.app,PULSE.app.common,PULSE.core,PULSE.I18N),function(e){e.matchWeekHeader=function(e){const t=this;t.container=e,t.currentContainer=e.querySelector(".js-gameweek-selector-current"),t.setListeners()},e.matchWeekHeader.prototype.setListeners=function(){const e=this;["click","keypress"].forEach((t=>{e.currentContainer.addEventListener(t,(function(n){("click"===t||"keypress"===t&&13===n.keyCode||32===n.keyCode)&&(e.container.classList.toggle("is-open"),n.preventDefault())}))}))};let t=document.querySelectorAll('[data-widget="match-week-header"]');Array.prototype.map.call(t,(function(t){t=new e.matchWeekHeader(t,{})}))}(PULSE.app,PULSE.core,PULSE.app.common,PULSE.ui,PULSE.I18N),function(e,t,n,a){e.matchWeekLatestTeamFilter=function(e,n){let a=this;a.element=e,a.gameweek=a.element.getAttribute("data-gameweek"),a.contentTypes={text:{container:a.element.closest(".centralContent").querySelectorAll(".js-article-list"),template:"latestmatchweektext"},video:{container:a.element.closest(".centralContent").querySelectorAll(".js-video-list"),template:"latestmatchweekvideo"}};for(let e in a.contentTypes)a.contentTypes[e].container&&a.contentTypes[e].container.length>0&&(a.contentTypes[e].limit=8,"video"===e&&(a.videoList=new t.videoList(a.contentTypes[e].container[0])));let o={callback:a.filterByTeam,updateCurrent:!0,target:a};new t.dropdown(a.element,o)},e.matchWeekLatestTeamFilter.prototype.filterByTeam=function(e){let t=this,n=e.getAttribute("data-club-id");t.clubId="-1"!=n?n:void 0,t.getMatchContent("text"),t.getMatchContent("video")},e.matchWeekLatestTeamFilter.prototype.renderContent=function(n,o){let l=this;if(n&&n.content){let i=o.contentType;if(l.contentTypes[i].container&&l.contentTypes[i].container.length>0){let o="",s=[];if(n.content.forEach((function(e){const n=t.getContentModel(e);let o;if("video"===e.type){const{title:e,closedCaptioned:t,uiArgs:l}=n,i={uiArgs:l,imgUrl:{default:n.onDemandUrl+"?width=451&height=268",mobile:n.onDemandUrl+"?width=344&height=215"},videoDuration:n.durationString,closedCaptioned:t,title:e};n.closedCaptioned&&(i.ccString=a.lookup("label.closedcaption")),function(e){let t;return e.references&&e.references.forEach((function(e){"ACCESSIBLE_VIDEO"===e.type&&(t=!0)})),t}(n)&&(i.avString=a.lookup("label.audiodescription")),o={...i,...n}}else o="text"===e.type&&n.onDemandUrl?{...n,imgUrl:{default:n.onDemandUrl+"?width=451&height=268",mobile:n.onDemandUrl+"?width=344&height=215"}}:{...n};s.push(o)})),n.content.length<1&&("video"===i||"text"===i))o=Mustache.render(e.templates.nomatchweeklatestlist,{label:a.lookup("label.nocontent"+i)});else{let t={contents:s};o=Mustache.render(e.templates[l.contentTypes[i].template],t)}l.contentTypes[i].container[0].innerHTML=o,"video"===i&&(l.videoList=new t.videoList(l.contentTypes.video.container[0]))}}},e.matchWeekLatestTeamFilter.prototype.getMatchContent=function(t){let n=this,a=["FOOTBALL_GAMEWEEK:"+n.gameweek];n.clubId&&a.push("FOOTBALL_CLUB:"+n.clubId);let o={references:a.join(","),limit:n.contentTypes[t].pageSize},l={url:e.common.createContentPath(t,o),method:"GET",callback:n.renderContent,contentType:t,target:this};this.startData(l)},e.matchWeekLatestTeamFilter.prototype.startData=function(e){n.data.manager.add(e)};let o=document.querySelectorAll('[data-widget="match-week-latest-team-filter"]');for(let t=0;t<o.length;t++)new e.matchWeekLatestTeamFilter(o[t],{})}(PULSE.app,PULSE.app.common,PULSE.core,PULSE.I18N),function(e,t,n,a){let o=function(t){let a=n.localStorage.getStorage(e.cookiePrefix+"Matchweekpoll"+t.id,!0);return!(!a||""==a)};e.matchWeekPoll=function(e,t){let n=this;n.element=e,n.gameweek=n.element.getAttribute("data-gameweek"),n.fanPollQuestionNumberContainer=n.element.getElementsByClassName("fanPollQuestionNumberContainer"),n.matchWeekPollButton=n.element.getElementsByClassName("matchWeekPollButton"),n.matchWeekQuestionContainer=n.element.getElementsByClassName("matchWeekQuestionContainer"),n.allQuestionsContainer=n.element.getElementsByClassName("allQuestionsContainer"),n.matchweekOptionsContainer=n.element.getElementsByClassName("matchweekOptionsContainer"),n.matchWeekOptionRenderContainer=n.element.getElementsByClassName("matchWeekOptionRenderContainer"),n.matchweekOptionsBackButton=n.element.getElementsByClassName("matchweekOptionsBackButton"),n.matchweekOptionsCloseButton=n.element.getElementsByClassName("matchweekOptionsCloseButton"),n.pollName="pl_2016_17",n.questions=[],n.answers=[],n.questionMap={},n.setListeners(),n.refreshPollData()},e.matchWeekPoll.prototype.setListeners=function(){let e=this;e.matchWeekPollButton&&e.matchWeekPollButton.length>0&&["click","keypress"].forEach((t=>{e.matchWeekPollButton[0].addEventListener(t,(function(a){("click"===t||"keypress"===t&&13===a.keyCode||32===a.keyCode)&&(e.matchWeekQuestionContainer&&e.matchWeekQuestionContainer.length>0&&(n.style.addClass(e.matchWeekQuestionContainer[0],"open"),n.style.addClass(e.element,"open")),a.preventDefault())}))})),e.allQuestionsContainer&&e.allQuestionsContainer.length>0&&["click","keypress"].forEach((t=>{e.allQuestionsContainer[0].addEventListener(t,(function(n){if("click"===t||"keypress"===t&&13===n.keyCode||32===n.keyCode){let t=n.target;for(;t&&t.parentNode!==e.allQuestionsContainer[0]&&t.parentNode&&"UL"!==t.parentNode.tagName;)if(t=t.parentNode,!t)return;if("LI"===t.tagName){let n=t.getAttribute("data-id");e.renderQuestion(n)}n.preventDefault()}}))})),e.matchweekOptionsBackButton&&e.matchweekOptionsBackButton.length>0&&["click","keypress"].forEach((t=>{e.matchweekOptionsBackButton[0].addEventListener(t,(function(n){("click"===t||"keypress"===t&&13===n.keyCode||32===n.keyCode)&&(e.currentQuestion=void 0,e.allQuestionsContainer&&e.allQuestionsContainer.length>0&&(e.allQuestionsContainer[0].style.display=""),e.matchweekOptionsContainer&&e.matchweekOptionsContainer.length>0&&(e.matchweekOptionsContainer[0].style.display="none"),n.preventDefault())}))})),e.matchweekOptionsCloseButton&&e.matchweekOptionsCloseButton.length>0&&["click","keypress"].forEach((t=>{e.matchweekOptionsCloseButton[0].addEventListener(t,(function(a){("click"===t||"keypress"===t&&13===a.keyCode||32===a.keyCode)&&(n.style.removeClass(e.matchWeekQuestionContainer[0],"open"),n.style.removeClass(e.element,"open"),a.preventDefault())}))})),e.matchWeekOptionRenderContainer&&e.matchWeekOptionRenderContainer.length>0&&["click","keypress"].forEach((t=>{e.matchWeekOptionRenderContainer[0].addEventListener(t,(function(n){if("click"===t||"keypress"===t&&13===n.keyCode||32===n.keyCode){let t=n.target;for(;t&&t.parentNode!==e.matchWeekOptionRenderContainer[0]&&t.parentNode&&"UL"!==t.parentNode.tagName;)if(t=t.parentNode,!t)return;if("LI"===t.tagName){let n=t.getAttribute("data-optionid"),a=t.getAttribute("data-questionid");null!=n&&null!=a&&e.answerQuestion(a,n)}n.preventDefault()}}))}))},e.matchWeekPoll.prototype.answerQuestion=function(e,a){let o={url:t.createPollAnswerUrl(e,a),method:"GET",callback:this.answeredQuestion,target:this,jsonpCallback:"JSON_CALLBACK",questionId:e,optionId:a};n.data.manager.add(o)},e.matchWeekPoll.prototype.answeredQuestion=function(t,a){let o=this;t&&a&&a.questionId&&n.localStorage.setStorage(e.cookiePrefix+"Matchweekpoll"+a.questionId,a.optionId,100,!0),o.questionMap[a.questionId]&&(o.questionMap[a.questionId].hasAnswer=!0,o.renderQuestion(a.questionId),o.initPollData(!0))},e.matchWeekPoll.prototype.initPollData=function(a){let o=this,l={url:t.createPollQuestionUrl(o.pollName),method:"GET",callback:o.renderPoll,target:this,jsonpCallback:"onPoll",forceCallback:!0,forced:a};a||(l.interval=e.pollingCacheRate),o.getPoll||a?a&&n.data.manager.add(l):o.getPoll=n.data.manager.add(l)},e.matchWeekPoll.prototype.refreshPollData=function(){this.initPollData()},e.matchWeekPoll.prototype.renderPoll=function(e,t){let n=this;if(e&&e.length>0){let a=!1,l=!1;e.forEach((function(e){if(e.open){let t=o(e);n.questionMap&&n.questionMap[n.currentQuestion]&&n.questionMap[n.currentQuestion].hasAnswer?e.hasAnswer=!0:e.hasAnswer=t,e.id==n.currentQuestion&&JSON.stringify(n.questionMap[n.currentQuestion])!=JSON.stringify(e)&&(l=!0),JSON.stringify(n.questionMap[e.id])!=JSON.stringify(e)&&(a=!0),n.questionMap[e.id]=e}})),(a||t.forced)&&(n.getQuestionAmount(),n.renderAllQuestions()),null!=n.currentQuestion&&l&&n.renderQuestion(n.currentQuestion)}},e.matchWeekPoll.prototype.refreshAnswersAndQuestions=function(e){let t=this;e.forEach((function(e){let n=o(e);e.hasAnswer=n,t.questionMap[e.id]=e}))},e.matchWeekPoll.prototype.renderQuestion=function(t){let n=this;if(n.currentQuestion=t,n.allQuestionsContainer&&n.allQuestionsContainer.length>0&&(n.allQuestionsContainer[0].style.display="none"),n.matchweekOptionsContainer&&n.matchweekOptionsContainer.length>0&&(n.matchweekOptionsContainer[0].style.display="",n.matchWeekOptionRenderContainer&&n.matchWeekOptionRenderContainer.length>0)){let a=n.questionMap[t];if(a){let t="pollquestions";a.hasAnswer&&(t="pollanswers");let o=0,l={question:a,idx:function(){return o++}};n.matchWeekOptionRenderContainer[0].innerHTML=Mustache.render(e.templates[t],l)}}},e.matchWeekPoll.prototype.getQuestionAmount=function(){let t=this;if(t.fanPollQuestionNumberContainer&&t.fanPollQuestionNumberContainer.length>0){let n="";if(t.questionMap){let a=0;for(let e in t.questionMap)t.questionMap[e].hasAnswer||a++;a>0&&(n+=Mustache.render(e.templates.pollquestionamount,{number:a}),t.fanPollQuestionNumberContainer[0].classList.add("has-questions"))}else t.fanPollQuestionNumberContainer[0].classList.remove("has-questions");t.fanPollQuestionNumberContainer[0].innerHTML=n}},e.matchWeekPoll.prototype.renderAllQuestions=function(){let n=this;if(n.allQuestionsContainer&&n.allQuestionsContainer.length>0){let o=[],l=[];for(let e in n.questionMap)n.questionMap[e].hasAnswer?l.push(n.questionMap[e]):o.push(n.questionMap[e]);let i={questions:o,answers:l,questionLabel:a.lookup("label.openquestions"),answerLabel:a.lookup("label.answeredquestions"),renderSVG:()=>e=>t.icon.renderSVG(e)};n.allQuestionsContainer[0].innerHTML=Mustache.render(e.templates.allquestions,i)}};let l=document.querySelectorAll('[data-widget="match-week-poll"]');for(let t=0;t<l.length;t++)new e.matchWeekPoll(l[t],{})}(PULSE.app,PULSE.app.common,PULSE.core,PULSE.I18N),function(e,t,n,a,o){e.matchWeekTable=function(e,n){let a=this;a.element=e,a.liveTableContainer=a.element.getElementsByClassName("liveTableContainer"),a.standingEntriesContainer=a.element.getElementsByClassName("standingEntriesContainer"),a.matchweekAmountContainer=a.element.getElementsByClassName("matchweekAmountContainer"),a.tableCloseButtonContainer=a.element.getElementsByClassName("tableCloseButtonContainer"),a.template=a.element.dataset.template||"matchweektable",a.drawDeductedPoints="true"===a.element.dataset.drawDeducted,a.drawDeductedCotainer=a.element.querySelector(".js-draw-deducted"),a.gameWeek=a.element.getAttribute("data-gameweek"),a.compSeason=a.element.getAttribute("data-compseason"),a.competition=a.element.getAttribute("data-competition"),a.gameweekAmount=a.element.getAttribute("data-gameweeknumber"),a.live=a.element.getAttribute("data-live"),a.liveLeague=a.element.getElementsByClassName("js-live-toggle-container"),a.setListeners(),t.style.toggleClass(a.element,"open"),a.compSeason&&a.live&&(a.shouldDisplayLiveLeague()?a.getLiveFixtures():a.getLiveTable(!1)),a.gameweekAmount&&a.compSeason&&a.checkSeasonAndGameweek(a.compSeason,a.gameweekAmount),a.gameWeek&&a.getCompSeason()},e.matchWeekTable.prototype.shouldDisplayLiveLeague=function(){let t=this;const n=e.summerSeries===parseInt(t.competition),a=e.competition.FIRST===parseInt(t.competition)&&!0;return t.liveLeague&&(a||n)},e.matchWeekTable.prototype.getLiveFixtures=function(){let e=this;e.liveFixtures=new n.liveFixtures({comps:e.competition,compSeason:e.compSeason,target:this,container:e.liveLeague[0],callback:e.gotLiveFixtures})},e.matchWeekTable.prototype.gotLiveFixtures=function(e){const t=e&&e.length;this.getLiveTable(t)},e.matchWeekTable.prototype.getCompSeason=function(){let n={id:this.gameWeek},a={url:e.common.createApiPath("gameweeks.single",n),method:"GET",callback:this.findCompSeason,target:this};t.data.manager.add(a)},e.matchWeekTable.prototype.findCompSeason=function(e){let t=this;e&&e.compSeason&&(e.gameweeks&&e.gameweeks.length>0&&(t.compSeason=e.compSeason.id,t.gameweekAmount=e.gameweeks[0].gameweek,t.checkSeasonAndGameweek(t.compSeason,t.gameweekAmount)),e.compSeason.competition&&(t.competition=e.compSeason.competition.id))},e.matchWeekTable.prototype.checkSeasonAndGameweek=function(e,t){let a=this;if(a.matchweekAmountContainer&&a.matchweekAmountContainer.length>0){let e=o.lookup("label.matchweek")+" "+t;a.matchweekAmountContainer[0].innerHTML=e}a.checkGameweek=new n.checkGameweek({compSeason:e,gameWeek:t,target:this,callback:a.initLiveTable})},e.matchWeekTable.prototype.toggleOpen=function(){let e=this;t.style.hasClass(e.element,"open")?e.stopFeed():e.startFeeds(),t.style.toggleClass(e.element,"open")},e.matchWeekTable.prototype.startFeeds=function(){let e=this;e.livePoll&&e.isLive&&e.livePoll.start()},e.matchWeekTable.prototype.setListeners=function(){let e=this;e.tableCloseButtonContainer&&e.tableCloseButtonContainer.length>0&&e.tableCloseButtonContainer[0].addEventListener("click",(function(){t.style.removeClass(e.element,"open"),e.stopFeed()}))},e.matchWeekTable.prototype.initLiveTable=function(e){let t=this;e&&t.shouldDisplayLiveLeague()?t.getLiveFixtures():t.getLiveTable(!1)},e.matchWeekTable.prototype.getLiveTable=function(t){let n=this,a={compSeasons:n.compSeason,altIds:!0};!t&&n.gameweekAmount?a.gameweekNumbers="1-"+n.gameweekAmount:t&&(a.live=!0);let o={url:e.common.createApiPath("standings.all",a),method:"GET",callback:n.renderTable,target:this};t&&(o.interval=6e4,n.isLive=!0),this.startData(o)},e.matchWeekTable.prototype.startData=function(e){this.livePoll=t.data.manager.add(e)},e.matchWeekTable.prototype.stopFeed=function(){let e=this;e.livePoll&&e.livePoll.stop()},e.matchWeekTable.prototype.renderTable=function(t){let a=this;if(t&&t.tables&&a.standingEntriesContainer&&a.standingEntriesContainer.length>0){t.tables;t.tables.forEach((function(t,o){let l="";if(t.entries&&(t.entries.sort((function(e,t){return e.position-t.position})),t.entries.forEach((function(t,o){let i=function(e){e.url=e.team&&e.team.club?n.generateContentUrl("team",e.team.club.id,e.team.club.name.replace(new RegExp(" ","g"),"-")):"",e.opta=e.team&&e.team.altIds&&e.team.altIds.opta?e.team.altIds.opta:"",e.clubBadge=n.getClubBadge(e.opta,"20"),e.clubBadgeRetina=n.getClubBadge(e.opta,"20",!0);let t=parseInt(e.overall.goalsDifference);return e.overall.goalsDifference=t>0?"+"+t:t,e.longName=e.team.club.shortName||e.team.shortName,e.movement="none",e.position<e.startingPosition?e.movement="up":e.position>e.startingPosition&&(e.movement="down"),e.annotationClass=n.getTableRowClass(e),e}(t);l+=Mustache.render(e.templates[a.template],i)}))),a.drawDeductedPoints){let o=n.getPointsDeducted(t.entries);a.drawDeductedCotainer.innerHTML=Mustache.render(e.templates.deductedpoints,{pointsDeducted:o}),a.drawDeductedCotainer.classList.remove("u-hide")}a.standingEntriesContainer[o]&&(a.standingEntriesContainer[o].innerHTML=l,e.clubBadge(a.standingEntriesContainer[o],!0))}))}};let l=document.querySelectorAll('[data-widget="match-week-table"]');Array.prototype.map.call(l,(function(t){t=new e.matchWeekTable(t,{})}))}(PULSE.app,PULSE.core,PULSE.app.common,PULSE.ui,PULSE.I18N);